version: "3"

services:
    router:
        build:
            context: .
            dockerfile: Dockerfile-ubuntu
        ports:
            - 5672:5672
        links:
            - artemis-1
            - artemis-2
        volumes:
            - ./router:/custom-config

    # Attention: The 2.3.0 version has the strange behaviour
    # that topics can not be created from on the client side!
    artemis-1:
        image: vromero/activemq-artemis:2.4.0
        ports:
          - 18161:8161
        environment:
          ARTEMIS_USERNAME: admin
          ARTEMIS_PASSWORD: admin

    artemis-2:
        image: vromero/activemq-artemis:2.4.0
        ports:
          - 28161:8161
        environment:
          ARTEMIS_USERNAME: admin
          ARTEMIS_PASSWORD: admin
